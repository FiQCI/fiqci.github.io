---
permalink: site.js
---
{%- capture publications -%}
[
{%- for publication in site.publications %}
 {% if post.hidden == null or post.hidden == false %}
    {
      "key": "{{ forloop.index }}",
      "type": "{{ publication.filters.Type | default: 'Post' }}",
      "title": "{{ publication.title }}",
      "url": "{{ publication.url | relative_url }}",
      "date": "{{ publication.date | date: '%-d.%-m.%Y' }}",
      "teaser": "{{ publication.header.teaser | relative_url }}",
      "hidden": "{{ publication.hidden | jsonify }}",
      "filters": {
        {%- for category in publication.filters %}
          "{{ category[0] }}": "{{ category[1] }}"
          {%- unless forloop.last -%},{%- endunless -%}
        {%- endfor %}
      } 
    }{%- unless forloop.last == true -%},{%- endunless -%}
  {% endif %}
{% endfor %}
]
{%- endcapture -%}

{%- capture events -%}
[
  {%- for event_post in site.events %}
  {
    "key": "{{ forloop.index }}",
    "type": "Event",
    "title": "{{ event_post.title }}",
    "url": "{{ event_post.link | uri_escape }}",
    "date": "{{ event_post.date | date: '%-d.%-m.%Y' }}",
    "content": {{ event_post.content | strip_html | strip_newlines | jsonify }},
    "filters": {
      {%- for category in event_post.filters %}
        "{{ category[0] }}": "{{ category[1] }}"
        {%- unless forloop.last -%},{%- endunless -%}
      {%- endfor %}
    }
  }{%- unless forloop.last -%},{%- endunless -%}
{% endfor %}
]
{%- endcapture -%}

const SITE = {
  deployment: { baseURL: "{{ site.baseurl }}" },
  publications: JSON.parse(String.raw`{{- publications -}}`),
  events: JSON.parse(String.raw`{{- events -}}`),
}
